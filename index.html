<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Miller95 Time Tracker Pro</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#667eea">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Miller95 Time Tracker">
    <meta name="description" content="Miller95 professional time tracking app for client work">
    
    <!-- PWA Icons -->
    <link rel="icon" type="image/png" sizes="192x192" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM2NjdlZWEiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiPgo8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPgo8cG9seWxpbmUgcG9pbnRzPSIxMiw2IDEyLDEyIDE2LDE0Ii8+Cjwvc3ZnPgo8L3N2Zz4K">
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM2NjdlZWEiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiPgo8Y2lyY2xlIGN4PSIxMiIgY3k9IjEyIiByPSIxMCIvPgo8cG9seWxpbmUgcG9pbnRzPSIxMiw2IDEyLDEyIDE2LDE0Ii8+Cjwvc3ZnPgo8L3N2Zz4K">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,eyJuYW1lIjoiVGltZSBUcmFja2VyIFBybyIsInNob3J0X25hbWUiOiJUaW1lVHJhY2tlciIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5Ijoic3RhbmRhbG9uZSIsImJhY2tncm91bmRfY29sb3IiOiIjZmZmZmZmIiwidGhlbWVfY29sb3IiOiIjNjY3ZWVhIiwiaWNvbnMiOlt7InNyYyI6ImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1Ua3lJaUJvWldsbmFIUTlJako5UWlJZ2RtbGxkMEp2ZUQwaU1DQXdJREU1TWlBeE9USWlJR1pwYkd3OUltNXZibVVpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUkrQ2p4eVpXTjBJSGRwWkhSb1BTSXhPVElpSUdobGFXZG9kRDBpTVRreUlpQnllRDBpTWpRaUlHWnBiR3c5SWlNMk5qZGxaV0VpTHo0S1BITjJaeUI0UFNJME9DSWdlVDBpTkRnaUlIZHBaSFJvUFNJNU5pSWdhR1ZwWjJoMFBTSTVOaUlnZG1sbGQwSnZlRDBpTUNBd0lESTBJREkwSWlCbWFXeHNQU0p1YjI1bElpQnpkSEp2YTJVOUluZG9hWFJsSWlCemRISnZhMlV0ZDJsa2RHZzlJaklpUGdvOFkybHlZMnhsSUdONFBTSXhNaUlnWTNrOUlqRXlJaUJ5UFNJeE1DSXZQZ284Y0c5c2VXeHBibVVnY0c5cGJuUnpQU0l4TWl3MklERXlMREV5SURFM0xERTBJaTgrQ2p3dmMzWm5QZ284TDNOMlp6NEsiLCJzaXplcyI6IjE5MngxOTIiLCJ0eXBlIjoiaW1hZ2Uvc3ZnK3htbCJ9XSwiZGlyZWN0aW9uIjoibHRyIiwibGFuZ3VhZ2UiOiJlbiIsIm9yaWVudGF0aW9uIjoicG9ydHJhaXQtcHJpbWFyeSJ9">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            overflow-x: hidden;
        }

        .container {
            max-width: 420px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            min-height: calc(100vh - 20px);
        }

        /* LOGIN SCREEN STYLES */
        .login-screen {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 40px 20px;
            text-align: center;
        }

        .login-logo {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
        }

        .login-logo svg {
            width: 40px;
            height: 40px;
            stroke: white;
            stroke-width: 2;
            fill: none;
        }

        .login-title {
            font-size: 28px;
            font-weight: bold;
            color: #333;
            margin-bottom: 10px;
        }

        .login-subtitle {
            color: #666;
            margin-bottom: 40px;
            font-size: 16px;
        }

        .login-form {
            width: 100%;
            max-width: 300px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-group input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e1e5e9;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s;
        }

        .form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
            margin-bottom: 20px;
        }

        .login-btn:active {
            transform: scale(0.98);
        }

        .demo-credentials {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            color: #666;
            border: 1px solid #e9ecef;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            border: 1px solid #f5c6cb;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-size: 14px;
            border: 1px solid #c3e6cb;
        }

        .form-toggle {
            display: flex;
            margin-bottom: 20px;
            border-radius: 25px;
            overflow: hidden;
            background: #f8f9fa;
        }

        .toggle-btn {
            flex: 1;
            padding: 12px;
            background: transparent;
            border: none;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        /* MAIN APP STYLES */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            position: relative;
        }

        .header h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .user-info {
            font-size: 14px;
            opacity: 0.9;
        }

        .logout-btn {
            background: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .logout-btn:hover {
            background: rgba(220, 53, 69, 0.2);
        }

        .logout-btn.active {
            background: #dc3545;
            color: white;
        }

        .logout-btn.active:hover {
            background: #c82333;
        }

        .activity-indicator {
            position: absolute;
            top: 15px;
            left: 20px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #28a745;
            animation: pulse 2s infinite;
        }

        .activity-indicator.inactive {
            background: #ffc107;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .main-content {
            padding: 20px;
            flex: 1;
        }

        .client-selector {
            margin-bottom: 20px;
        }

        .client-selector label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .client-input-group {
            display: flex;
            gap: 10px;
        }

        select, input {
            flex: 1;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            background: white;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
        }

        .add-client-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 12px 16px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }

        .timer-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            text-align: center;
        }

        .timer-display {
            font-size: 48px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            font-family: 'Courier New', monospace;
        }

        .timer-controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .timer-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .timer-btn:active {
            transform: scale(0.98);
        }

        .start-btn {
            background: #28a745;
            color: white;
        }

        .stop-btn {
            background: #dc3545;
            color: white;
        }

        .pause-btn {
            background: #ffc107;
            color: #333;
        }

        .manual-entry {
            display: flex;
            gap: 10px;
            align-items: center;
            font-size: 14px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .manual-entry input {
            width: 80px;
            padding: 8px;
            text-align: center;
        }

        .task-notes {
            margin-top: 15px;
        }

        .task-notes textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            min-height: 60px;
        }

        .task-notes textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .task-notes textarea::placeholder {
            color: #999;
        }

        .today-summary {
            margin-bottom: 20px;
        }

        .summary-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .summary-header h3 {
            color: #333;
        }

        .total-time {
            background: #667eea;
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .time-entries {
            max-height: 300px;
            overflow-y: auto;
        }

        .time-entry {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 10px;
            margin-bottom: 8px;
        }

        .client-name {
            font-weight: 600;
            color: #333;
        }

        .entry-time {
            color: #666;
            font-size: 14px;
        }

        .entry-notes {
            font-size: 13px;
            color: #666;
            margin-top: 4px;
            font-style: italic;
            line-height: 1.3;
        }

        .entry-actions {
            display: flex;
            gap: 5px;
            align-items: center;
        }

        .edit-note-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 11px;
            cursor: pointer;
        }

        .delete-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 5px;
            font-size: 12px;
            cursor: pointer;
        }

        .bottom-nav {
            display: flex;
            background: #f8f9fa;
            border-top: 1px solid #e1e5e9;
        }

        .nav-btn {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            font-size: 14px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .nav-btn.active {
            background: #667eea;
            color: white;
        }

        .nav-btn:hover {
            background: #e9ecef;
        }

        .nav-btn.active:hover {
            background: #5a6fd8;
        }

        .hidden {
            display: none !important;
        }

        /* REPORTS SECTION */
        .reports-section {
            padding: 20px;
        }

        .report-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .export-btn {
            background: #17a2b8;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
        }

        /* SETTINGS SECTION */
        .settings-section {
            padding: 20px;
        }

        .setting-group {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border: 1px solid #e9ecef;
        }

        .setting-group h4 {
            margin-bottom: 10px;
            color: #333;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .setting-item:last-child {
            margin-bottom: 0;
        }

        .toggle-switch {
            position: relative;
            width: 50px;
            height: 24px;
            background: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.3s;
        }

        .toggle-switch.active {
            background: #28a745;
        }

        .toggle-switch::before {
            content: '';
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: white;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
        }

        .toggle-switch.active::before {
            transform: translateX(26px);
        }

        /* MODAL STYLES */
        .inactivity-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 20px;
            max-width: 350px;
            margin: 20px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal-content h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 20px;
        }

        .modal-content p {
            color: #666;
            margin-bottom: 25px;
            line-height: 1.4;
        }

        .modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 12px 24px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .modal-btn:active {
            transform: scale(0.98);
        }

        .continue-btn {
            background: #28a745;
            color: white;
        }

        .pause-btn-modal {
            background: #ffc107;
            color: #333;
        }

        .stop-btn-modal {
            background: #dc3545;
            color: white;
        }

        /* RESPONSIVE DESIGN */
        @media (max-width: 480px) {
            .container {
                margin: 0;
                border-radius: 0;
                min-height: 100vh;
            }

            .timer-display {
                font-size: 36px;
            }

            .timer-controls {
                gap: 10px;
            }

            .timer-btn {
                padding: 10px 20px;
                font-size: 14px;
            }

            .manual-entry {
                flex-direction: column;
                gap: 10px;
            }

            .client-input-group {
                flex-direction: column;
            }
        }

        /* PWA INSTALL PROMPT */
        .install-prompt {
            background: #e3f2fd;
            border: 1px solid #90caf9;
            border-radius: 10px;
            padding: 15px;
            margin: 20px;
            text-align: center;
            position: relative;
        }

        .install-btn {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            margin-top: 10px;
        }

        .close-install {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 18px;
            cursor: pointer;
            color: #666;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-logo">
            <img src="gsp-logo.png" alt="GSP Logo" style="width: 80px; height: 80px; border-radius: 20px; object-fit: cover;" onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
            <div style="font-size: 40px; display: none;">🐕</div>
        </div>
        <h1 class="login-title">Miller95 Time Tracker Pro</h1>
        <p class="login-subtitle">Secure client time tracking</p>
        
        <div id="errorMessage" class="error-message hidden">
            Invalid credentials. Please try again.
        </div>
        
        <div id="successMessage" class="success-message hidden">
            Account created successfully! Please sign in.
        </div>
        
        <!-- Login Form -->
        <form id="loginForm" class="login-form" onsubmit="handleLogin(event)">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" required autocomplete="username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" required autocomplete="current-password">
            </div>
            <button type="submit" class="login-btn">Sign In</button>
        </form>

        <!-- Signup Form -->
        <form id="signupForm" class="login-form hidden" onsubmit="handleSignup(event)">
            <div class="form-group">
                <label for="signupFullName">Full Name</label>
                <input type="text" id="signupFullName" name="fullName" required>
            </div>
            <div class="form-group">
                <label for="signupUsername">Username</label>
                <input type="text" id="signupUsername" name="username" required minlength="3">
            </div>
            <div class="form-group">
                <label for="signupEmail">Email</label>
                <input type="email" id="signupEmail" name="email" required>
            </div>
            <div class="form-group">
                <label for="signupPassword">Password</label>
                <input type="password" id="signupPassword" name="password" required minlength="6">
            </div>
            <div class="form-group">
                <label for="confirmPassword">Confirm Password</label>
                <input type="password" id="confirmPassword" name="confirmPassword" required minlength="6">
            </div>
            <button type="submit" class="login-btn">Create Account</button>
        </form>
        
        <!-- Form Toggle Buttons -->
        <div class="form-toggle">
            <button id="showLogin" class="toggle-btn active" onclick="showLoginForm()">Sign In</button>
            <button id="showSignup" class="toggle-btn" onclick="showSignupForm()">Sign Up</button>
        </div>
        
        <div class="demo-credentials">
            <strong>Demo Account:</strong><br>
            Username: sarah<br>
            Password: timetrack123
        </div>
    </div>

    <!-- Main App Container -->
    <div id="mainApp" class="container hidden">
        <!-- PWA Install Prompt -->
        <div id="installPrompt" class="install-prompt hidden">
            <button class="close-install" onclick="hideInstallPrompt()">×</button>
            <strong>Install App</strong><br>
            Add Miller95 Time Tracker to your home screen for easy access!
            <br><button class="install-btn" onclick="installPWA()">Install Now</button>
        </div>

        <!-- Header -->
        <div class="header">
            <div class="activity-indicator" id="activityIndicator"></div>
            <h1>Miller95 Time Tracker Pro</h1>
            <div class="user-info" id="userInfo">Welcome back!</div>
        </div>

        <!-- Main App Content -->
        <div id="main-app">
            <!-- Timer Tab -->
            <div id="timer-tab" class="main-content">
                <!-- Client Selection -->
                <div class="client-selector">
                    <label>Select Client:</label>
                    <div class="client-input-group">
                        <select id="clientSelect">
                            <option value="">Choose client...</option>
                            <option value="abc-corp">ABC Corporation</option>
                            <option value="smith-llc">Smith LLC</option>
                            <option value="downtown-cafe">Downtown Cafe</option>
                        </select>
                        <button class="add-client-btn" onclick="addNewClient()">+ Add</button>
                    </div>
                </div>

                <!-- Timer Section -->
                <div class="timer-section">
                    <div class="timer-display" id="timerDisplay">00:00:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn start-btn" onclick="startTimer()">Start</button>
                        <button class="timer-btn pause-btn" onclick="pauseTimer()">Pause</button>
                        <button class="timer-btn stop-btn" onclick="stopTimer()">Stop</button>
                    </div>
                    <div class="manual-entry">
                        Manual entry: 
                        <input type="number" placeholder="0" min="0" max="23"> h
                        <input type="number" placeholder="0" min="0" max="59"> m
                        <button class="add-client-btn" onclick="addManualTime()">Add</button>
                    </div>
                    <div class="task-notes">
                        <textarea id="currentTaskNotes" placeholder="What are you working on? (notes will be saved with this time block)" rows="2"></textarea>
                    </div>
                </div>

                <!-- Today's Summary -->
                <div class="today-summary">
                    <div class="summary-header">
                        <h3>Today's Time</h3>
                        <div class="total-time">Total: 6h 45m</div>
                    </div>
                    <div class="time-entries">
                        <div class="time-entry">
                            <div>
                                <div class="client-name">ABC Corporation</div>
                                <div class="entry-time">9:00 AM - 12:30 PM</div>
                                <div class="entry-notes">Meeting with stakeholders, reviewed project requirements, updated documentation</div>
                            </div>
                            <div class="entry-actions">
                                <span>3h 30m</span>
                                <button class="edit-note-btn" onclick="editNote(this)">✎</button>
                                <button class="delete-btn" onclick="deleteEntry(this)">×</button>
                            </div>
                        </div>
                        <div class="time-entry">
                            <div>
                                <div class="client-name">Smith LLC</div>
                                <div class="entry-time">1:30 PM - 4:45 PM</div>
                                <div class="entry-notes">Development work on invoice system, bug fixes, testing</div>
                            </div>
                            <div class="entry-actions">
                                <span>3h 15m</span>
                                <button class="edit-note-btn" onclick="editNote(this)">✎</button>
                                <button class="delete-btn" onclick="deleteEntry(this)">×</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Reports Tab -->
            <div id="reports-tab" class="hidden">
                <div class="reports-section">
                    <h3 style="margin-bottom: 20px;">Monthly Reports</h3>
                    
                    <div class="report-card">
                        <div class="report-header">
                            <div>
                                <strong>June 2025</strong>
                                <div style="font-size: 14px; color: #666;">Total: 168h 30m</div>
                            </div>
                            <button class="export-btn" onclick="exportReport('june-2025')">Export PDF</button>
                        </div>
                        <div style="font-size: 14px;">
                            <div>ABC Corporation: 85h 15m</div>
                            <div>Smith LLC: 62h 45m</div>
                            <div>Downtown Cafe: 20h 30m</div>
                        </div>
                    </div>

                    <div class="report-card">
                        <div class="report-header">
                            <div>
                                <strong>May 2025</strong>
                                <div style="font-size: 14px; color: #666;">Total: 142h 15m</div>
                            </div>
                            <button class="export-btn" onclick="exportReport('may-2025')">Export PDF</button>
                        </div>
                        <div style="font-size: 14px;">
                            <div>ABC Corporation: 78h 30m</div>
                            <div>Smith LLC: 48h 45m</div>
                            <div>Downtown Cafe: 15h 00m</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div id="settings-tab" class="hidden">
                <div class="settings-section">
                    <h3 style="margin-bottom: 20px;">Settings</h3>
                    
                    <div class="setting-group">
                        <h4>Timer Settings</h4>
                        <div class="setting-item">
                            <span>Auto-save entries</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
                        </div>
                        <div class="setting-item">
                            <span>Sound notifications</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
                        </div>
                        <div class="setting-item">
                            <span>24-hour format</span>
                            <div class="toggle-switch" onclick="toggleSetting(this)"></div>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h4>Inactivity Settings</h4>
                        <div class="setting-item">
                            <span>Inactivity warnings</span>
                            <div class="toggle-switch active" onclick="toggleSetting(this)"></div>
                        </div>
                        <div class="setting-item">
                            <span>Warning after (minutes)</span>
                            <select style="width: 80px; padding: 5px;">
                                <option value="15">15</option>
                                <option value="20" selected>20</option>
                                <option value="30">30</option>
                                <option value="60">60</option>
                            </select>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h4>Data & Privacy</h4>
                        <div class="setting-item">
                            <button class="export-btn" onclick="exportAllData()">Export All Data</button>
                        </div>
                        <div class="setting-item">
                            <button class="delete-btn" onclick="clearAllData()">Clear All Data</button>
                        </div>
                    </div>

                    <div class="setting-group">
                        <h4>Account</h4>
                        <div class="setting-item">
                            <button class="export-btn" onclick="changePassword()">Change Password</button>
                        </div>
                        <div class="setting-item">
                            <span>Version: 1.0.0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <div class="bottom-nav">
            <button class="nav-btn active" onclick="showTab('timer')">⏱️ Timer</button>
            <button class="nav-btn" onclick="showTab('reports')">📊 Reports</button>
            <button class="nav-btn" onclick="showTab('settings')">⚙️ Settings</button>
            <button class="nav-btn" onclick="logout()">🚪 Logout</button>
        </div>

        <!-- Inactivity Check Modal -->
        <div id="inactivityModal" class="inactivity-modal hidden">
            <div class="modal-content">
                <h3>Still Working?</h3>
                <p>You've been inactive for 20 minutes. Are you still working on this task?</p>
                <div class="modal-buttons">
                    <button class="modal-btn continue-btn" onclick="continueWorking()">Continue</button>
                    <button class="modal-btn pause-btn-modal" onclick="pauseFromModal()">Pause</button>
                    <button class="modal-btn stop-btn-modal" onclick="stopFromModal()">Stop</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // PWA Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('data:text/javascript;base64,' + btoa(`
                    const CACHE_NAME = 'time-tracker-v1';
                    const urlsToCache = ['/'];

                    self.addEventListener('install', event => {
                        event.waitUntil(
                            caches.open(CACHE_NAME)
                                .then(cache => cache.addAll(urlsToCache))
                        );
                    });

                    self.addEventListener('fetch', event => {
                        event.respondWith(
                            caches.match(event.request)
                                .then(response => {
                                    if (response) {
                                        return response;
                                    }
                                    return fetch(event.request);
                                })
                        );
                    });
                `))
                .then(registration => {
                    console.log('SW registered: ', registration);
                })
                .catch(registrationError => {
                    console.log('SW registration failed: ', registrationError);
                });
            });
        }

        // PWA Install prompt
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            showInstallPrompt();
        });

        function showInstallPrompt() {
            document.getElementById('installPrompt').classList.remove('hidden');
        }

        function hideInstallPrompt() {
            document.getElementById('installPrompt').classList.add('hidden');
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        console.log('User accepted the install prompt');
                    }
                    deferredPrompt = null;
                    hideInstallPrompt();
                });
            }
        }

        // App State Management
        class AppState {
            constructor() {
                this.currentUser = null;
                this.isAuthenticated = false;
                this.users = this.loadUsers();
                this.clients = [
                    { id: 'abc-corp', name: 'ABC Corporation' },
                    { id: 'smith-llc', name: 'Smith LLC' },
                    { id: 'downtown-cafe', name: 'Downtown Cafe' }
                ];
                this.timeEntries = [];
                this.settings = {
                    autoSave: true,
                    soundNotifications: false,
                    use24HourFormat: false,
                    inactivityWarnings: true,
                    inactivityTimeout: 20
                };
                this.loadFromStorage();
            }

            loadUsers() {
                const defaultUsers = {
                    'sarah': { 
                        password: 'timetrack123', 
                        fullName: 'Sarah Demo', 
                        email: 'sarah@demo.com',
                        created: new Date().toISOString()
                    },
                    'admin': { 
                        password: 'admin123', 
                        fullName: 'Admin User', 
                        email: 'admin@demo.com',
                        created: new Date().toISOString()
                    }
                };

                try {
                    const stored = window.appUsers;
                    return stored ? { ...defaultUsers, ...stored } : defaultUsers;
                } catch (e) {
                    return defaultUsers;
                }
            }

            saveUsers() {
                try {
                    window.appUsers = this.users;
                } catch (e) {
                    console.warn('Could not save users');
                }
            }

            saveToStorage() {
                const data = {
                    clients: this.clients,
                    timeEntries: this.timeEntries,
                    settings: this.settings
                };
                try {
                    window.appData = data;
                } catch (e) {
                    console.warn('Storage not available');
                }
            }

            loadFromStorage() {
                try {
                    const data = window.appData;
                    if (data) {
                        this.clients = data.clients || this.clients;
                        this.timeEntries = data.timeEntries || [];
                        this.settings = { ...this.settings, ...data.settings };
                    }
                } catch (e) {
                    console.warn('Could not load from storage');
                }
            }

            createUser(username, password, fullName, email) {
                if (this.users[username]) {
                    throw new Error('Username already exists');
                }

                if (username.length < 3) {
                    throw new Error('Username must be at least 3 characters');
                }

                if (password.length < 6) {
                    throw new Error('Password must be at least 6 characters');
                }

                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(email)) {
                    throw new Error('Please enter a valid email address');
                }

                this.users[username] = {
                    password: password,
                    fullName: fullName,
                    email: email,
                    created: new Date().toISOString(),
                    lastLogin: null
                };

                this.saveUsers();
                return true;
            }

            authenticateUser(username, password) {
                const user = this.users[username];
                if (user && user.password === password) {
                    user.lastLogin = new Date().toISOString();
                    this.saveUsers();
                    return user;
                }
                return null;
            }
        }

        // Initialize app state
        const appState = new AppState();

        // Timer state
        let timerInterval = null;
        let startTime = null;
        let elapsedTime = 0;
        let isRunning = false;
        let lastActivityTime = Date.now();
        let inactivityCheckInterval = null;
        let inactivityWarningShown = false;

        // Authentication functions
        function showLoginForm() {
            document.getElementById('loginForm').classList.remove('hidden');
            document.getElementById('signupForm').classList.add('hidden');
            document.getElementById('showLogin').classList.add('active');
            document.getElementById('showSignup').classList.remove('active');
            clearMessages();
        }

        function showSignupForm() {
            document.getElementById('loginForm').classList.add('hidden');
            document.getElementById('signupForm').classList.remove('hidden');
            document.getElementById('showLogin').classList.remove('active');
            document.getElementById('showSignup').classList.add('active');
            clearMessages();
        }

        function clearMessages() {
            document.getElementById('errorMessage').classList.add('hidden');
            document.getElementById('successMessage').classList.add('hidden');
        }

        function showError(message) {
            document.getElementById('errorMessage').textContent = message;
            document.getElementById('errorMessage').classList.remove('hidden');
            document.getElementById('successMessage').classList.add('hidden');
        }

        function showSuccess(message) {
            document.getElementById('successMessage').textContent = message;
            document.getElementById('successMessage').classList.remove('hidden');
            document.getElementById('errorMessage').classList.add('hidden');
        }

        function handleSignup(event) {
            event.preventDefault();
            
            const fullName = document.getElementById('signupFullName').value.trim();
            const username = document.getElementById('signupUsername').value.toLowerCase().trim();
            const email = document.getElementById('signupEmail').value.trim();
            const password = document.getElementById('signupPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            // Validation
            if (password !== confirmPassword) {
                showError('Passwords do not match');
                return;
            }

            if (fullName.length < 2) {
                showError('Please enter your full name');
                return;
            }

            try {
                appState.createUser(username, password, fullName, email);
                showSuccess('Account created successfully! Please sign in.');
                
                // Clear form
                document.getElementById('signupForm').reset();
                
                // Switch to login form after 2 seconds
                setTimeout(() => {
                    showLoginForm();
                    document.getElementById('username').value = username;
                }, 2000);
                
            } catch (error) {
                showError(error.message);
            }
        }

        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value.toLowerCase().trim();
            const password = document.getElementById('password').value;
            
            const user = appState.authenticateUser(username, password);
            
            if (user) {
                appState.currentUser = username;
                appState.isAuthenticated = true;
                document.getElementById('loginScreen').classList.add('hidden');
                document.getElementById('mainApp').classList.remove('hidden');
                document.getElementById('userInfo').textContent = `Welcome back, ${user.fullName}!`;
                
                // Initialize app after login
                initializeApp();
                clearMessages();
            } else {
                showError('Invalid username or password');
                setTimeout(() => {
                    clearMessages();
                }, 3000);
            }
        }

        function logout() {
            if (confirm('Are you sure you want to logout?')) {
                // Stop any running timers
                if (isRunning) {
                    stopTimer();
                }
                
                // Clear auth state
                appState.currentUser = null;
                appState.isAuthenticated = false;
                
                // Show login screen
                document.getElementById('mainApp').classList.add('hidden');
                document.getElementById('loginScreen').classList.remove('hidden');
                
                // Clear form
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
            }
        }

        function initializeApp() {
            updateTimerDisplay();
            loadClients();
            
            // Track activity on any user interaction
            document.addEventListener('click', trackActivity);
            document.addEventListener('keypress', trackActivity);
            document.addEventListener('touchstart', trackActivity);
            
            updateActivityIndicator();
            
            console.log('App initialized for user:', appState.currentUser);
        }

        function loadClients() {
            const select = document.getElementById('clientSelect');
            select.innerHTML = '<option value="">Choose client...</option>';
            
            appState.clients.forEach(client => {
                const option = document.createElement('option');
                option.value = client.id;
                option.textContent = client.name;
                select.appendChild(option);
            });
        }

        // Timer functions
        function updateTimerDisplay() {
            const hours = Math.floor(elapsedTime / 3600);
            const minutes = Math.floor((elapsedTime % 3600) / 60);
            const seconds = elapsedTime % 60;
            
            document.getElementById('timerDisplay').textContent = 
                `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        }

        // Activity tracking functions
        function updateActivityIndicator() {
            const indicator = document.getElementById('activityIndicator');
            const timeSinceLastActivity = Date.now() - lastActivityTime;
            
            if (timeSinceLastActivity > 300000) { // 5 minutes
                indicator.classList.add('inactive');
            } else {
                indicator.classList.remove('inactive');
            }
        }

        function trackActivity() {
            lastActivityTime = Date.now();
            inactivityWarningShown = false;
            updateActivityIndicator();
        }

        function checkInactivity() {
            if (!isRunning) return;
            
            const timeSinceLastActivity = Date.now() - lastActivityTime;
            const warningTime = appState.settings.inactivityTimeout * 60 * 1000;
            
            if (timeSinceLastActivity >= warningTime && !inactivityWarningShown && appState.settings.inactivityWarnings) {
                showInactivityModal();
                inactivityWarningShown = true;
            }
        }

        function showInactivityModal() {
            document.getElementById('inactivityModal').classList.remove('hidden');
        }

        function hideInactivityModal() {
            document.getElementById('inactivityModal').classList.add('hidden');
        }

        function continueWorking() {
            trackActivity();
            hideInactivityModal();
            console.log('User confirmed still working');
        }

        function pauseFromModal() {
            pauseTimer();
            hideInactivityModal();
            console.log('Timer paused from inactivity modal');
        }

        function stopFromModal() {
            stopTimer();
            hideInactivityModal();
            console.log('Timer stopped from inactivity modal');
        }

        function startInactivityMonitoring() {
            if (inactivityCheckInterval) {
                clearInterval(inactivityCheckInterval);
            }
            inactivityCheckInterval = setInterval(checkInactivity, 60000);
            setInterval(updateActivityIndicator, 30000);
        }

        function stopInactivityMonitoring() {
            if (inactivityCheckInterval) {
                clearInterval(inactivityCheckInterval);
                inactivityCheckInterval = null;
            }
        }

        function startTimer() {
            const clientSelect = document.getElementById('clientSelect');
            if (!clientSelect.value) {
                alert('Please select a client first!');
                return;
            }

            if (!isRunning) {
                startTime = Date.now() - (elapsedTime * 1000);
                timerInterval = setInterval(() => {
                    elapsedTime = Math.floor((Date.now() - startTime) / 1000);
                    updateTimerDisplay();
                }, 1000);
                isRunning = true;
                trackActivity();
                startInactivityMonitoring();
                console.log(`Started timer for ${clientSelect.options[clientSelect.selectedIndex].text}`);
            }
        }

        function pauseTimer() {
            if (isRunning) {
                clearInterval(timerInterval);
                isRunning = false;
                stopInactivityMonitoring();
                console.log('Timer paused');
            }
        }

        function stopTimer() {
            if (timerInterval) {
                clearInterval(timerInterval);
                timerInterval = null;
                isRunning = false;
                stopInactivityMonitoring();
                
                if (elapsedTime > 0) {
                    const clientSelect = document.getElementById('clientSelect');
                    const taskNotes = document.getElementById('currentTaskNotes').value;
                    
                    console.log(`Stopped timer. Total time: ${Math.floor(elapsedTime / 3600)}h ${Math.floor((elapsedTime % 3600) / 60)}m`);
                    console.log(`Client: ${clientSelect.options[clientSelect.selectedIndex].text}`);
                    console.log(`Notes: ${taskNotes}`);
                    
                    // Save time entry
                    if (appState.settings.autoSave) {
                        saveTimeEntry(clientSelect.value, elapsedTime, taskNotes);
                    }
                    
                    document.getElementById('currentTaskNotes').value = '';
                }
                
                elapsedTime = 0;
                updateTimerDisplay();
            }
        }

        function saveTimeEntry(clientId, duration, notes) {
            const client = appState.clients.find(c => c.id === clientId);
            const entry = {
                id: Date.now(),
                clientId: clientId,
                clientName: client ? client.name : 'Unknown',
                duration: duration,
                notes: notes,
                date: new Date().toISOString().split('T')[0],
                startTime: new Date(Date.now() - (duration * 1000)),
                endTime: new Date()
            };
            
            appState.timeEntries.push(entry);
            appState.saveToStorage();
            console.log('Time entry saved:', entry);
        }

        function addNewClient() {
            const newClientName = prompt('Enter client name:');
            if (newClientName && newClientName.trim()) {
                const clientId = newClientName.toLowerCase().replace(/\s+/g, '-') + '-' + Date.now();
                const newClient = { id: clientId, name: newClientName.trim() };
                
                appState.clients.push(newClient);
                appState.saveToStorage();
                
                const select = document.getElementById('clientSelect');
                const option = document.createElement('option');
                option.value = clientId;
                option.textContent = newClientName.trim();
                select.appendChild(option);
                select.value = clientId;
                
                console.log(`Added new client: ${newClientName.trim()}`);
            }
        }

        function addManualTime() {
            const clientSelect = document.getElementById('clientSelect');
            const hours = document.querySelector('.manual-entry input:nth-of-type(1)').value || 0;
            const minutes = document.querySelector('.manual-entry input:nth-of-type(2)').value || 0;
            const taskNotes = document.getElementById('currentTaskNotes').value;
            
            if (!clientSelect.value) {
                alert('Please select a client first!');
                return;
            }
            
            if (parseInt(hours) === 0 && parseInt(minutes) === 0) {
                alert('Please enter a time amount!');
                return;
            }
            
            trackActivity();
            const totalSeconds = (parseInt(hours) * 3600) + (parseInt(minutes) * 60);
            saveTimeEntry(clientSelect.value, totalSeconds, taskNotes);
            
            console.log(`Added manual time: ${hours}h ${minutes}m for ${clientSelect.options[clientSelect.selectedIndex].text}`);
            console.log(`Notes: ${taskNotes}`);
            
            // Clear inputs
            document.querySelector('.manual-entry input:nth-of-type(1)').value = '';
            document.querySelector('.manual-entry input:nth-of-type(2)').value = '';
            document.getElementById('currentTaskNotes').value = '';
        }

        function editNote(button) {
            const timeEntry = button.closest('.time-entry');
            const notesDiv = timeEntry.querySelector('.entry-notes');
            const currentNotes = notesDiv.textContent;
            
            const newNotes = prompt('Edit notes for this time entry:', currentNotes);
            if (newNotes !== null) {
                notesDiv.textContent = newNotes;
                console.log(`Updated notes: ${newNotes}`);
            }
        }

        function deleteEntry(button) {
            if (confirm('Delete this time entry?')) {
                button.closest('.time-entry').remove();
                console.log('Time entry deleted');
            }
        }

        function showTab(tabName) {
            // Hide all tabs
            document.getElementById('timer-tab').classList.add('hidden');
            document.getElementById('reports-tab').classList.add('hidden');
            document.getElementById('settings-tab').classList.add('hidden');
            
            // Show selected tab
            document.getElementById(tabName + '-tab').classList.remove('hidden');
            
            // Update nav buttons (exclude logout button from active state)
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.textContent.toLowerCase().includes(tabName)) {
                    btn.classList.add('active');
                }
            });
        }

        function toggleSetting(toggle) {
            toggle.classList.toggle('active');
            // Here you would update the actual setting in appState.settings
            console.log('Setting toggled:', toggle.classList.contains('active'));
        }

        function exportReport(period) {
            alert(`Exporting ${period} report as PDF...`);
            console.log(`Export report: ${period}`);
        }

        function exportAllData() {
            const data = {
                clients: appState.clients,
                timeEntries: appState.timeEntries,
                exportDate: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(data, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'time-tracker-data.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                appState.clients = appState.clients.slice(0, 3); // Keep default clients
                appState.timeEntries = [];
                appState.saveToStorage();
                alert('All data cleared successfully.');
                loadClients();
            }
        }

        function changePassword() {
            const currentUser = appState.users[appState.currentUser];
            const currentPassword = prompt('Enter your current password:');
            
            if (currentUser.password === currentPassword) {
                const newPassword = prompt('Enter your new password (minimum 6 characters):');
                if (newPassword && newPassword.length >= 6) {
                    const confirmPassword = prompt('Confirm your new password:');
                    if (newPassword === confirmPassword) {
                        currentUser.password = newPassword;
                        appState.saveUsers();
                        alert('Password changed successfully!');
                    } else {
                        alert('Passwords do not match.');
                    }
                } else {
                    alert('Password must be at least 6 characters long.');
                }
            } else {
                alert('Current password is incorrect.');
            }
        }

        // Initialize when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Check if user was previously logged in (in a real app, you'd use secure tokens)
            if (appState.isAuthenticated) {
                initializeApp();
            }
        });
    </script>
</body>
</html>
